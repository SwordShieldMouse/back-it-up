#!/bin/bash
#SBATCH --job-name=Swimmer_fkl
#SBATCH --output=./logs/Swimmer/fkl/%A%a.out
#SBATCH --error=./logs/Swimmer/fkl/%A%a.err

#SBATCH --array=0-2283:4%200

#SBATCH --cpus-per-task=1
#SBATCH --time=12:00:00
#SBATCH --mem-per-cpu=8000M

#SBATCH --account=rrg-whitem

ENV_NAME=Swimmer-v2
AGENT_NAME=forward_kl_big

ERROR_RUNS=(1540 1680 1820 1960 2100 2380 2520 2660 2800 2940 3220 3360 3500 3640 3780 3920 4060 1681 1821 1961 2101 2241 2381 2661 2801 2941 3081 3361 3501 3641 3781 3921 4061 1542 1682 1822 2102 2242 2382 2522 2662 2802 3082 3222 3362 3502 3642 3922 4062 1403 1543 1823 1963 2103 2243 2383 2663 2943 3083 3223 3363 3503 3643 3923 4063 1404 1544 1684 1824 1964 2104 2244 2384 2524 2664 2804 2944 3084 3364 3504 3644 3924 4064 1545 1685 1825 2245 2525 2665 2805 2945 3085 3225 3365 3505 3645 3785 3925 4065 1406 1546 1686 1826 1966 2246 2526 2946 3226 3366 3646 3926 4066 1407 1547 1687 1827 1967 2107 2247 2387 2527 2667 2807 2947 3087 3227 3507 3647 3787 3927 4067 1688 1828 1968 2108 2248 2388 2528 2668 2948 3088 3228 3368 3508 3648 3928 4068 1409 1549 1689 1969 2109 2249 2389 2529 2949 3089 3229 3649 3789 3929 4069 1410 1690 1830 1970 2110 2530 2670 2810 2950 3090 3230 3370 3510 3650 3790 3930 4070 1411 1551 1831 1971 2111 2251 2391 2671 2811 2951 3091 3231 3371 3511 3651 3791 3931 4071 1412 1692 1832 1972 2112 2252 2392 2532 2672 2812 2952 3092 3232 3652 3792 3932 4072 1413 1833 1973 2113 2393 2533 2673 2953 3233 3513 3793 3933 4073 1414 1554 1834 1974 2254 2394 2534 2674 2814 2954 3094 3374 3934 4074 1415 1695 1835 1975 2115 2255 2395 2535 2955 3095 3375 3515 3655 3795 3935 1556 1696 1836 1976 2116 2256 2396 2536 2676 2816 2956 3096 3376 3516 3656 3796 3936 4076 1417 1837 2117 2257 2397 2537 2677 3237 3377 3517 3657 3797 3937 4077 1698 1838 1978 2118 2258 2398 2538 2678 2818 3098 3238 3378 3518 3658 4078 1559 1699 1839 2119 2259 2399 2679 2819 2959 3099 3239 3379 3659 3939 4079 1420 1560 1840 2260 2400 2540 2680 2820 2960 3100 3240 3380 3520 3940 4080 1561 1701 1841 1981 2401 2541 2681 2821 2961 3101 3241 3381 3521 3661 3941 4081 1702 1982 2122 2262 2402 2542 2682 2822 2962 3102 3242 3382 3522 3662 3942 4082 1423 1563 1843 2123 2263 2403 2683 2963 3243 3383 3523 3663 3803 3943 4083 1424 1704 1844 1984 2124 2264 2404 2544 2964 3384 3524 3664 3804 4084 1425 1565 1705 1845 1985 2125 2265 2405 2545 2825 2965 3105 3245 3385 3525 3805 3945 4085 1426 1566 1846 1986 2126 2266 2406 2546 2686 2826 2966 3106 3246 3386 3526 3666 3806 3946 4086 1427 1567 1847 1987 2127 2267 2407 2547 2687 2827 2967 3107 3247 3387 3527 3667 3807 3947 1428 1568 1708 1848 1988 2128 2268 2408 2548 2688 2828 2968 3108 3248 3388 3528 3668 3808 3948 4088 1569 1849 1989 2129 2269 2409 2549 2689 2829 3109 3249 3389 3529 3669 3809 3949 4089 1430 1570 1710 1850 1990 2130 2270 2410 2550 2690 2830 2970 3110 3250 3390 3530 3670 3810 3950 4090 1711 1851 1991 2131 2271 2411 2551 2691 2831 2971 3111 3251 3531 3671 3811 3951 4091 2132 2272 2552 2692 2972 3112 3252 3392 3532 3672 3812 3952 4092 1433 1573 1853 2133 2273 2413 2553 2973 3253 3393 3533 3673 3813 4093 1434 1574 1714 1854 2134 2274 2414 2554 2834 3114 3254 3394 3534 3674 3814 3954 4094 1435 1715 1855 1995 2135 2275 2415 2555 2695 2835 2975 3115 3255 3395 3535 3815 3955 4095 1576 1716 1996 2276 2416 2556 2696 2836 2976 3116 3256 3396 3676 3816 3956 4096 1437 1577 1717 1857 1997 2137 2277 2417 2557 2697 2837 2977 3117 3257 3397 3677 3817 3957 4097 1438 1578 1718 1858 1998 2138 2278 2418 2558 2698 2838 2978 3118 3258 3398 3538 3678 3818 4098 1579 1719 2139 2279 2419 2559 2699 2839 2979 3119 3259 3399 3539 3679 3819 3959 4099 1440 1580 1720 1860 2000 2140 2560 2700 2840 2980 3120 3260 3400 3680 3820 3960 4100 1441 1721 1861 2001 2281 2421 2561 2701 2841 2981 3121 3401 3541 3681 3961 4101 1442 1582 1722 1862 2002 2142 2282 2422 2562 2702 2842 2982 3122 3262 3402 3542 3682 3822 3962 4102 1443 1583 1723 1863 2003 2143 2283 2423 2563 2703 2983 3263 3543 3683 3823 3963 4103 1584 1724 1864 2004 2144 2284 2424 2564 2844 2984 3124 3404 3544 3684 3824 3964 4104 1445 1585 1725 2005 2285 2425 2565 2705 2845 2985 3125 3405 3545 3685 3825 3965 4105 1586 1726 2006 2286 2426 2706 2846 2986 3126 3266 3406 3546 3686 3826 3966 1447 1587 1727 1867 2007 2147 2287 2567 2707 3127 3407 3687 3967 4107 1448 1588 1728 2008 2148 2568 2708 2848 2988 3128 3268 3408 3548 3828 3968 4108 1449 1589 1729 2009 2709 2849 2989 3129 3409 3549 3829 3969 4109 1870 2150 2290 2430 2570 2710 2850 2990 3130 3270 3410 3550 3690 3830 3970 4110 1451 1591 1731 1871 2011 2151 2291 2431 2571 2711 2851 2991 3131 3411 3551 3831 4111 1452 1592 1872 2012 2152 2432 2572 2712 2852 3132 3412 3552 3692 3832 3972 4112 1453 1593 1733 2013 2153 2433 2573 2853 3133 3273 3413 3553 3693 3833 3973 4113 1454 1594 2014 2154 2294 2434 2574 2714 2994 3134 3274 3414 3554 3694 3834 3974 4114 1455 1595 1735 1875 2015 2155 2295 2435 2575 2715 2995 3135 3275 3415 3555 3695 3835 3975 4115 1456 1596 1876 2016 2436 2576 2716 2856 2996 3136 3416 3556 3696 3836 3976 4116 1457 1597 1877 2017 2157 2437 2577 2717 2857 2997 3277 3417 3557 3697 3837 3977 4117 1458 1598 1878 2158 2298 2438 2578 2718 2998 3138 3418 3558 3698 3838 3978 4118 1459 1599 1739 1879 2019 2159 2299 2439 2579 2719 3139 3279 3419 3559 3699 3979 4119 1460 1600 1880 2020 2160 2300 2440 2580 2720 2860 3000 3140 3280 3560 3700 3840 4120 1461 1601 1881 2021 2161 2441 2861 3001 3141 3281 3561 3701 3841 3981 4121 1462 1602 1742 1882 2162 2302 2442 2582 2722 2862 3002 3282 3562 3702 3842 3982 4122 1463 1603 1743 2163 2303 2443 2583 2723 2863 3003 3283 3703 3843 4123 1464 1604 1744 2024 2164 2304 2444 2584 2724 2864 3004 3144 3284 3424 3564 3704 3844 3984 4124 1745 1885 2025 2165 2305 2445 2585 2725 2865 3005 3145 3285 3425 3565 3705 3845 4125 1466 1886 2026 2166 2306 2446 2586 2726 2866 3006 3146 3286 3566 3846 3986 4126 1467 1747 1887 2027 2167 2307 2447 2587 2727 2867 3007 3147 3287 3427 3567 3987 4127 1468 1608 1748 1888 2168 2308 2448 2588 2728 2868 3008 3148 3288 3708 3848 3988 4128 1609 1749 1889 2029 2169 2309 2449 2729 2869 3009 3289 3429 3569 3709 3849 3989 4129 1470 1610 1750 1890 2170 2310 2450 2590 2730 2870 3150 3430 3570 3710 3850 3990 4130 1611 1751 1891 2171 2311 2451 2591 2731 2871 3011 3151 3291 3431 3571 3851 4131 1472 1612 1892 2032 2172 2592 2732 2872 3152 3292 3572 3712 3852 3992 4132 1613 1893 2173 2313 2453 2593 2733 2873 3013 3153 3293 3433 3573 3713 3853 4133 1474 1614 1894 2174 2454 2594 2734 3014 3154 3294 3434 3574 3854 4134 1475 1615 1755 1895 2035 2315 2455 2735 3295 3435 3575 3715 3855 1476 1616 1756 1896 2176 2316 2456 2596 2736 3016 3156 3296 3576 3716 3856 3996 1477 1617 1757 1897 2037 2177 2317 2457 2597 2737 2877 3017 3157 3437 3577 3717 3857 3997 1478 1618 1758 1898 2038 2178 2318 2458 2738 2878 3158 3578 3858 4138 1479 1619 1759 1899 2039 2179 2319 2459 2599 2739 2879 3019 3299 3439 3579 3719 3859 3999 4139 1620 1760 1900 2180 2320 2460 2600 2740 2880 3020 3300 3580 3720 3860 4000 4140 1481 1621 2041 2181 2461 2601 2741 2881 3021 3161 3301 3441 3581 3721 3861 4001 4141 1482 1622 1902 2042 2182 2322 2602 2742 2882 3022 3162 3442 3582 3722 3862 4142 1483 1623 1763 1903 2043 2183 2323 2463 2603 2743 3023 3163 3303 3583 3863 4003 4143 1484 1624 1764 1904 2044 2324 2464 2604 2744 2884 3024 3164 3304 3444 3584 3724 3864 4004 4144 1485 1625 1765 1905 2045 2325 2465 2605 2745 2885 3165 3305 3445 3725 4005 4145 1626 1766 2046 2606 2746 2886 3026 3166 3306 3586 3726 3866 4006 4146 1487 2047 2187 2327 2467 2607 2887 3027 3167 3307 3727 3867 4007 4147 1488 1628 1768 1908 2188 2328 2748 2888 3028 3168 3448 3588 3728 3868 4008 4148 1629 1909 2189 2469 2609 2749 3029 3309 3589 3729 3869 4009 4149 1630 1910 2050 2190 2330 2610 2750 2890 3170 3310 3450 3590 3730 3870 4010 4150 1491 1631 1911 2051 2331 2471 2611 2751 3031 3311 3591 3731 3871 4011 4151 1492 1632 2052 2192 2472 3032 3172 3312 3452 3592 3732 3872 4012 4152 1633 1773 1913 2053 2193 2333 2473 2613 2753 2893 3173 3313 3453 3593 3733 3873 1494 1634 1774 1914 2054 2334 2474 2614 2754 3174 3314 3454 3594 3734 3874 4014 4154 1495 1635 1775 1915 2055 2195 2335 2475 2755 2895 3035 3175 3455 3595 3735 3875 4015 4155 1496 1776 1916 2056 2196 2336 2476 2616 2756 2896 3036 3176 3316 3596 3736 3876 4016 4156 1497 1637 1777 1917 2057 2197 2337 2477 2617 2757 3037 3177 3317 3877 4017 4157 1498 1638 1918 2058 2198 2338 2478 2618 2758 2898 3178 3318 3458 3598 3878 4018 4158 1499 1639 1779 2059 2759 2899 3319 3459 3599 3739 3879 4019 4159 1500 1640 1920 2060 2200 2340 2480 2620 2760 2900 3180 3320 3460 3600 3880 4020 4160 1501 1641 2061 2201 2341 2481 2621 2761 2901 3181 3321 3601 3741 3881 4021 4161 1502 1642 1782 1922 2062 2202 2342 2482 2762 2902 3042 3182 3322 3602 3882 4022 4162 1643 1923 2063 2203 2343 2483 2623 2763 2903 3043 3183 3323 3463 3603 3743 3883 4023 4163 1504 1784 1924 2204 2344 2484 2764 2904 3044 3184 3324 3464 3604 3884 4164 1505 1645 1785 1925 2065 2205 2485 2625 2765 2905 3045 3325 3465 3885 4025 1506 1786 1926 2066 2206 2346 2486 2626 2766 2906 3046 3186 3326 3466 3606 3746 4026 4166 1647 1927 2067 2207 2347 2627 2767 2907 3047 3467 3607 3747 3887 4027 4167 1508 1648 1788 1928 2068 2208 2348 2488 2628 2768 2908 3048 3188 3468 3608 3888 4028 4168 1509 1789 1929 2069 2209 2349 2489 2769 2909 3189 3469 3609 3889 4029 4169 1650 1930 2070 2210 2350 2490 2770 2910 3330 3470 3750 3890 4030 4170 1511 1651 1931 2211 2351 2491 2631 2771 3051 3331 3471 3751 3891 4171 1512 1652 1932 2072 2352 2492 2632 2912 3052 3192 3332 3472 3612 3892 4032 4172 1513 1653 2073 2213 2353 2493 2913 3053 3193 3333 3473 3613 3753 3893 4033 4173 1514 1934 2074 2214 2354 2494 2634 2774 2914 3054 3194 3474 3614 3754 3894 4034 4174 1515 1655 1795 1935 2075 2355 2495 2635 2775 3055 3195 3475 3615 3895 4175 1516 1796 1936 2076 2356 2496 2636 2776 2916 3056 3336 3476 3616 3756 3896 4176 1517 1657 1797 1937 2217 2357 2497 2637 2777 2917 3057 3197 3477 3757 3897 4037 4177 1518 1658 1798 2078 2218 2358 2498 2778 2918 3058 3198 3338 3478 3618 3758 3898 4038 4178 1519 1659 1799 2079 2219 2359 2499 2779 2919 3199 3339 3759 3899 4039 1520 1660 1800 1940 2080 2220 2360 2500 2920 3060 3200 3340 3480 3760 3900 4040 4180 1521 1661 1801 1941 2361 2501 2641 2781 2921 3061 3201 3341 3481 3621 3901 4041 4181 1522 1802 1942 2082 2222 2362 2502 2642 2782 2922 3062 3202 3342 3482 3622 3762 3902 4042 4182 1523 1803 2083 2223 2363 2643 2783 3203 3343 3483 3623 3763 4043 4183 1524 1664 1804 2084 2224 2364 2504 2784 3064 3204 3344 3484 3624 3764 3904 4044 4184 1525 1665 1805 2085 2225 2365 2505 2645 2925 3345 3485 3625 3765 3905 4045 4185 1526 1666 1806 1946 2086 2226 2506 2646 3626 3766 3906 4046 4186 1527 1667 1807 1947 2087 2367 2507 2647 2927 3067 3207 3347 3487 3627 3767 3907 4047 4187 1668 1808 1948 2088 2368 2508 2648 2788 2928 3068 3208 3348 3488 3628 3768 3908 4048 4188 1529 1669 1949 2229 2369 2509 2649 2789 3069 3209 3349 3629 3769 4049 4189 1670 1810 2090 2230 2370 2510 2650 2790 3070 3210 3350 3490 4050 4190 1531 1671 1811 1951 2231 2371 2511 2651 2791 2931 3071 3211 3351 3491 3631 3771 3911 4051 4191 1532 1672 1812 1952 2092 2232 2372 2512 2652 2792 2932 3072 3212 3352 3492 3632 3772 4192 1533 1673 1813 2093 2233 2373 2513 2653 2793 2933 3073 3213 3353 3633 3773 3913 4053 4193 1534 1814 2234 2374 2514 2654 2794 2934 3074 3214 3354 3494 3634 3774 4054 1535 1675 1815 1955 2095 2235 2375 2515 2655 2935 3075 3215 3355 3495 3775 3915 4055 4195 1536 1676 1956 2096 2236 2376 2516 2656 2796 2936 3076 3216 3496 3636 3776 3916 4056 4196 1537 1677 2097 2237 2377 2517 2657 2797 2937 3217 3357 3497 3637 3777 3917 4057 4197 1678 1818 1958 2098 2238 2378 2518 2658 2798 2938 3078 3218 3358 3498 3638 3778 3918 4058 4198 1539 1679 1819 1959 2099 2379 2519 2659 2799 2939 3219 3359 3499 3779 3919 4199)

echo Running..$ENV_NAME $AGENT_NAME $SLURM_ARRAY_TASK_ID

export OMP_NUM_THREADS=1
export MKL_NUM_THREADS=1

THESE_ERROR_RUNS=()

let "end_idx=$SLURM_ARRAY_TASK_ID+3"
for ((i=$SLURM_ARRAY_TASK_ID; i<= $end_idx; i++)); do
    THESE_ERROR_RUNS+=( ${ERROR_RUNS[$i]} )
done

increment=1

parallel --jobs 4 "source ~/sungsu_env/bin/activate; bash experiments/continuous_deep_control/slurm_scripts/run_script_template.sh $ENV_NAME $AGENT_NAME {}" ::: ${THESE_ERROR_RUNS[@]}
