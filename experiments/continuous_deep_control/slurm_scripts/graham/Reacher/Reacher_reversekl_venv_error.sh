#!/bin/bash
#SBATCH --job-name=Reacher_rpm_mul
#SBATCH --output=./logs/Reacher/rkl/%A%a.out
#SBATCH --error=./logs/Reacher/rkl/%A%a.err

#SBATCH --array=0-1802:4

#SBATCH --cpus-per-task=4
#SBATCH --time=9:30:00
#SBATCH --mem-per-cpu=8000M

#SBATCH --account=def-whitem


ENV_NAME=Reacher-v2
AGENT_NAME=reverse_kl_rpm_big

ERROR_RUNS=(1760 2080 2880 3200 3680 3840 4000 4320 4480 4640 1601 2081 2241 2561 3201 3521 3681 4481 1602 1922 2082 2722 3202 3362 3682 4482 1603 1763 1923 2083 2403 2563 2723 2883 3043 3203 3523 3683 3843 4163 4323 4483 1764 2244 2564 2724 2884 3044 3204 3364 3524 3684 4164 4324 4484 2245 2405 2565 3045 3365 3845 4005 4165 4325 4485 2246 2566 3046 3206 3366 4166 4326 4486 4646 1607 1767 1927 2087 2247 2567 2727 3047 3367 3847 4007 4167 4327 4487 1768 1928 2088 2408 2568 2888 3048 3208 3368 3528 3848 4008 4168 4328 4648 1929 2089 2409 2569 3049 3209 3369 3529 3849 4009 4169 4649 1610 1770 1930 2090 2250 2410 2570 2730 2890 3050 3210 3370 3530 3690 3850 4010 4170 4490 4650 1931 2091 2411 2571 2891 3051 3211 3371 3531 3691 3851 4011 4171 4651 1612 1772 2732 2892 3212 4172 4492 1773 2093 2253 2733 2893 3213 4173 4493 1774 2414 2574 2734 3054 3214 3374 3854 4014 4174 4494 4654 1775 1935 2255 2735 3215 3535 3695 4175 4335 4495 4655 1616 1936 2096 3056 3376 4176 4496 4656 1617 1777 1937 2097 2417 2577 3057 3377 3857 4177 4497 4657 1778 1938 2098 2258 2898 3058 3218 3378 3698 4018 4178 4498 4658 1939 2099 2739 3059 3379 3539 4179 4339 4499 4659 1780 1940 2100 2260 2580 2900 3060 4020 2101 2261 2741 3061 3221 3541 4661 1782 2102 2262 3062 3702 3862 4182 4342 4662 1623 2103 2263 3063 3223 3383 3863 4023 4183 4503 1624 1944 2104 2424 2584 3064 3384 3544 3704 4184 4344 4504 4664 1625 1945 2105 2265 2425 2585 2745 3065 3385 3545 4025 4345 4505 1626 1786 1946 2106 2266 2426 2586 2746 3066 3386 3546 3706 3866 4346 4506 1627 1787 1947 2107 2427 2587 2907 3067 3227 3387 3547 3867 4347 4507 2268 2748 2908 3068 3548 4028 4348 1629 2589 2909 3389 3549 3869 4669 1790 2270 2750 3070 3230 3550 4190 4510 1951 2111 2431 3231 3551 3711 4671 1632 1952 2272 2432 2592 3232 3392 3712 3872 4672 1633 2273 2593 3393 3713 3873 4033 4353 1634 2274 2594 2754 2914 3394 3714 3874 1635 1795 1955 2115 2275 2595 2915 3075 3395 3555 3715 3875 4195 4515 1796 1956 2596 2916 3236 3396 3716 3876 4036 4196 4516 4676 1957 2437 2597 3077 3397 3557 3877 4037 4197 4517 4677 1638 1798 1958 2438 2598 2758 3398 3718 3878 4038 4198 4358 4518 4678 1959 2119 2279 2599 2919 3399 3879 4039 4199 4359 4519 4679 1640 2120 2280 2440 2600 3080 3240 3720 4040 4360 4680 1641 1961 2121 2441 3081 3241 3721 4041 4201 4361 4521 1642 1802 2122 2282 2442 2762 3082 3242 3402 3562 3722 4042 4362 1643 1963 2123 2443 2923 3083 3243 3563 3723 3883 4043 4363 1804 2124 2284 2444 2604 2764 2924 3724 3884 1805 1965 2125 2925 3085 3405 3725 3885 4045 1806 1966 2926 3246 3726 3886 4206 4366 4526 1647 1807 2127 2287 2927 3087 3567 3727 3887 4367 4527 4687 1648 1808 1968 2128 2288 2768 2928 3088 3248 3568 3728 3888 4208 1809 1969 2129 2609 2929 3569 3889 4049 4209 4369 1810 1970 2130 2450 2610 2770 3570 3890 4050 4210 4530 4690 1811 2131 2451 2931 3091 3411 3571 3731 3891 4051 4211 1812 1972 2292 2612 2772 2932 3092 3412 3732 3892 4052 4212 4532 1653 1813 2293 2613 2773 2933 3413 3573 3733 4213 4533 4693 1654 1814 1974 2294 2614 2774 3254 3414 3734 4054 4214 4534 4694 1815 2135 2295 2455 2615 2775 3415 3735 4375 4535 1656 1816 2936 3256 3576 3736 4056 4216 1657 1817 2137 2297 2617 2937 3257 3737 4057 4217 4377 4537 1658 1818 2138 2458 2778 2938 3098 3258 3418 3578 3738 4058 4218 4698 1659 1819 1979 2619 2779 2939 3259 3739 4059 4219 4699 1980 2300 2460 2940 3260 3420 3580 3740 4220 1661 1821 2461 2621 2781 2941 3261 3581 3741 3901 4061 4221 2462 2942 3102 3262 3422 3582 3742 3902 4222 4382 4542 4702 1983 2143 2303 2463 2943 3263 3423 3583 3743 3903 4223 4543 4703 1824 1984 2624 3424 3744 4064 4224 4384 4704 1825 2625 3105 3585 3745 4065 4225 4385 4705 1666 1826 2626 3106 3266 3746 3906 4066 4226 4386 4706 1667 1827 2147 2307 2467 2627 2787 2947 3427 3587 3747 4067 4227 4387 4547 4707 2148 2308 2468 2628 3428 4068 4548 4708 2309 2469 2949 3429 3589 3749 4069 4229 4389 4549 4709 1990 2310 2470 2630 2790 3110 3270 3910 4070 4390 4550 4710 1671 1831 2311 2471 2791 3111 4071 4391 4551 4711 1832 1992 2472 2632 3752 4072 4232 1833 1993 2153 2633 3593 4233 4393 4553 1834 1994 2634 2794 2954 3434 4234 4394 4714 1675 1835 1995 2155 2315 2635 2955 3115 3275 3435 3915 4235 4715 1676 1836 2156 2636 3116 4556 1677 1837 1997 2157 2637 2797 2957 3117 3437 3597 3757 4397 4557 1838 2158 2318 2478 2638 2798 3118 3438 3598 3758 4238 4558 1839 2159 2319 2479 2639 3119 3279 3919 4079 4399 4559 4719 1680 1840 2000 2160 2640 2960 3280 3600 3760 3920 4560 1841 2001 2481 2641 3281 3601 4081 4561 1842 2002 2322 2642 3282 3442 3602 4242 4402 4562 4722 1843 2003 2323 2643 2803 3123 3283 3603 3763 4403 4563 4723 2324 2484 2644 3284 3444 3604 3924 4084 4244 4404 4564 4724 2165 2485 2645 3125 3285 3925 4085 4245 4405 4565 4725 1686 2486 2806 2966 3286 3606 3766 3926 4086 4246 4406 4566 4726 1687 1847 2007 2487 2807 2967 3287 3927 4087 4247 4407 4567 4727 1688 1848 2008 2488 2808 2968 3128 3288 3608 4088 4248 4568 4728 2169 2649 2809 2969 3289 3449 3769 3929 4089 4249 4729 1690 1850 2170 2810 2970 3290 3930 4090 4250 4410 4730 2331 2811 2971 3291 4091 4251 4731 1692 2012 2652 2812 2972 3292 3452 3612 3932 4092 4252 4412 4572 4732 1693 2173 2653 2973 3293 3453 3613 3773 3933 4093 4253 4413 1694 2174 2334 2494 2654 2974 3294 3454 3614 3774 3934 4094 4254 4414 1695 1855 2495 2655 2975 3135 3295 3455 3615 3935 4095 4255 4415 4575 4735 1696 2016 2496 2656 2976 3136 3296 3456 3936 4096 4576 2017 2337 3137 3297 3457 3937 4097 4257 1698 1858 2018 2178 2818 3138 3298 3458 3618 3938 4098 2019 2659 3139 3299 3459 3619 3779 3939 4099 4419 4579 4739 1860 2820 3460 3620 3780 4420 4580 1701 1861 2021 2181 3461 3621 4581 4741 1862 2342 2982 3302 3462 3622 3942 4102 4262 4422 4582 1863 2503 2663 3143 3463 3623 3783 4583 1704 1864 2184 2344 2984 3144 3304 3464 3784 4104 4424 4744 1705 1865 2185 2985 3305 3465 3785 4105 4425 1706 1866 2026 2506 2666 2986 3146 3306 3466 3626 3786 3946 4106 4746 1707 1867 2507 2827 2987 3307 3467 3787 4107 4267 4587 4747 1868 2188 2348 2668 2828 2988 3468 3628 3788 3948 4108 4588 1869 2189 2349 2509 2669 2989 3309 3469 3789 3949 4109 4589 1710 2350 2670 2990 3470 3790 3950 4110 4590 4750 1711 2031 2351 2671 2991 3151 3471 3631 3791 3951 4111 4271 4431 4591 4751 1712 1872 2192 2352 2512 2672 3312 3792 3952 4112 4272 4432 4592 4752 1873 2353 3313 3793 4273 4593 4753 1874 2194 2354 2674 2834 3474 3634 3794 3954 4274 4594 4754 1875 2035 2355 2515 2995 3155 3475 3795 4275 4595 4755 1716 2676 2996 3316 3796 4596 1877 2517 2677 2837 2997 3317 3477 3637 3957 4277 4597 4757 2038 2198 2678 2998 3158 3318 3478 4118 4278 4438 4598 2359 2679 2999 3319 3799 4599 4759 1720 1880 2040 2360 2840 3160 3320 3800 4120 4760 1881 2841 3321 3641 3801 4121 4601 1882 2042 2202 2522 2682 2842 3162 3322 3482 3802 3962 4122 4282 4442 1723 1883 2843 3003 3323 3483 3643 3803 3963 4123 4763 1724 2364 2524 2684 2844 3004 3484 3644 4124 4444 4604 4764 2205 2525 2845 3005 3485 3645 3965 4445 4605 4765 2046 2526 2846 3006 3166 3486 3646 4286 4446 4606 4766 1727 1887 2047 2527 2847 3007 3327 3487 3647 3807 4287 4447 4607 4767 1728 1888 2528 2848 3008 3168 3328 3488 3648 3968 4128 4448 4608 2049 2529 2689 3009 3169 3329 3489 3649 3969 4129 4449 2050 2210 2530 3010 3170 3330 3490 3970 4130 4290 4450 4770 2371 2531 2851 3011 3171 3331 3491 3651 3971 4131 4451 4611 1732 2372 2692 2852 3012 3172 3332 3652 3812 4292 4452 2053 2373 2533 2853 3013 3173 3333 3493 3653 3813 4293 4453 4773 1894 2054 2214 2374 2854 3014 3174 3334 3654 3814 3974 4294 4454 4614 2375 2855 3015 3175 3335 3495 3655 3815 3975 4135 4295 4455 4615 4775 2056 2216 2536 2856 3016 3496 3656 3816 3976 4296 4456 4616 4776 1737 2057 2377 2537 2857 3337 3497 3657 3817 3977 4297 4457 4617 4777 2058 2218 2538 2858 3498 3658 3818 3978 4138 4458 4618 4778 1899 2059 2539 2699 2859 3179 3499 3659 3819 3979 4459 4619 4779 1740 1900 2380 2700 3020 3180 3500 3820 3980 4140 4300 4620 4780 1741 1901 2221 2381 2701 2861 3021 3341 3501 3821 3981 4141 4301 4461 4621 1742 2062 2382 2542 2702 2862 3022 3342 3502 3822 3982 4142 4302 4622 1743 2063 2383 2703 3023 3183 3503 3663 3823 3983 4143 4303 4623 4783 2064 2224 2384 2704 2864 3024 3184 3344 3504 3824 3984 4144 4304 4784 2225 2545 2705 2865 3025 3185 3345 3505 3825 3985 4145 4305 2066 2226 2546 2706 2866 3026 3186 3346 3506 3666 3826 4146 4306 4466 4626 1747 1907 2067 2227 2707 2867 3027 3187 3347 3507 3667 3827 4147 4307 4787 1748 2068 2228 2548 2868 3348 3508 3668 3828 3988 4148 4468 4788 1749 1909 2069 2549 2709 3029 3189 3989 4309 4469 4629 4789 1750 2070 2390 2550 2710 3030 3350 3510 3990 4470 4790 1751 2071 2551 3351 3511 3831 3991 4471 4791 1912 2072 2712 3192 3512 3832 3992 4472 4632 1913 2233 2553 3193 3353 3513 3993 4153 4313 4473 4793 1754 1914 2874 3194 3674 3994 4474 1915 2075 2395 2875 3035 3195 3995 4155 4315 4475 1916 2076 2396 2716 2876 3036 3516 3676 3836 4156 4316 4476 4636 4796 1757 1917 2077 2397 2557 3037 3677 3837 4157 4317 4477 4637 1918 2078 2398 3038 3198 3358 3518 3678 3838 4158 4318 4478 4638 1759 1919 2079 2239 2399 2719 2879 3039 3359 3679 3839 3999 4159 4319 4479 4639)

echo Running..$ENV_NAME $AGENT_NAME $SLURM_ARRAY_TASK_ID

export OMP_NUM_THREADS=1
export MKL_NUM_THREADS=1

THESE_ERROR_RUNS=()

let "end_idx=$SLURM_ARRAY_TASK_ID+3"
for ((i=$SLURM_ARRAY_TASK_ID; i<= $end_idx; i++)); do
    THESE_ERROR_RUNS+=( ${ERROR_RUNS[$i]} )
done

increment=1

parallel --jobs 4 "source ~/sungsu_env/bin/activate; bash experiments/continuous_deep_control/slurm_scripts/run_script_template.sh $ENV_NAME $AGENT_NAME {}" ::: ${THESE_ERROR_RUNS[@]}


